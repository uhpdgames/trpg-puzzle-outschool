var Imported=Imported||{};Imported.LeTBS_AutoMode=!0;var Lecode=Lecode||{};Lecode.S_TBS.AutoMode={};var parameters=PluginManager.parameters("LeTBS_AutoBattle");function Window_TBSAutoMode(){this.initialize.apply(this,arguments)}Lecode.S_TBS.AutoMode.commandText=String(parameters["Command Text"]||"Auto Battle"),Lecode.S_TBS.AutoMode.input=String(parameters.Input||"tab"),Lecode.S_TBS.AutoMode.oldWindowTBSEndCommand_makeCommandList=Window_TBSEndCommand.prototype.makeCommandList,Window_TBSEndCommand.prototype.makeCommandList=function(){Lecode.S_TBS.AutoMode.oldWindowTBSEndCommand_makeCommandList.call(this),this.addCommand(Lecode.S_TBS.AutoMode.commandText,"auto_mode",!0)},Lecode.S_TBS.AutoMode.oldSB_createAllWindows=Scene_Battle.prototype.createAllWindows,Scene_Battle.prototype.createAllWindows=function(){Lecode.S_TBS.AutoMode.oldSB_createAllWindows.call(this),Lecode.S_TBS.commandOn&&this.createAutoModeWindow()},Scene_Battle.prototype.createAutoModeWindow=function(){this._windowAutoMode=new Window_TBSAutoMode,this._windowAutoMode.hide(),this.addWindow(this._windowAutoMode)},Lecode.S_TBS.AutoMode.oldSB_createEndCommandWindow=Scene_Battle.prototype.createEndCommandWindow,Scene_Battle.prototype.createEndCommandWindow=function(){Lecode.S_TBS.AutoMode.oldSB_createEndCommandWindow.call(this),this._windowEndCommand.setHandler("auto_mode",this.setAutoMode.bind(this))},Scene_Base.prototype.setAutoMode=function(){BattleManagerTBS._autoModePending=!BattleManagerTBS._autoModePending,BattleManagerTBS._autoModePending?this._windowAutoMode.show():this._windowAutoMode.hide(),this._windowEndCommand.activate(),this._windowAutoMode.refresh()},Lecode.S_TBS.AutoMode.oldSB_start=Scene_Battle.prototype.start,Scene_Battle.prototype.start=function(){Lecode.S_TBS.AutoMode.oldSB_start.call(this),Lecode.S_TBS.commandOn&&BattleManagerTBS._autoModePending&&(BattleManagerTBS._autoModePending=!1,this.setAutoMode())},Lecode.S_TBS.AutoMode.oldTBSEntity_playableByAI=TBSEntity.prototype.playableByAI,TBSEntity.prototype.playableByAI=function(){return!!BattleManagerTBS._autoMode||Lecode.S_TBS.AutoMode.oldTBSEntity_playableByAI.call(this)},Window_TBSAutoMode.prototype=Object.create(Window_Base.prototype),(Window_TBSAutoMode.prototype.constructor=Window_TBSAutoMode).prototype.initialize=function(){var t=this.windowWidth(),e=this.windowHeight();Window_Base.prototype.initialize.call(this,0,0,t,e),this.x=Graphics.width-t,this.y=Graphics.height-e,this.opacity=0,this.contentsOpacity=175},Window_TBSAutoMode.prototype.windowWidth=function(){return 300},Window_TBSAutoMode.prototype.windowHeight=function(){return this.fittingHeight(1)},Window_TBSAutoMode.prototype.refresh=function(){this.contents.clear(),this.resetFontSettings();var t=BattleManagerTBS._autoMode?"Auto Mode ON":BattleManagerTBS._autoModePending?"Pending Auto Mode":"";this.leU_drawText(t,"center",0)},BattleManagerTBS.processAutoBattle=function(){var t=this.activeEntity(),e=t.battler();this.newAction(e,!0),this.startAiTurn(t)},Lecode.S_TBS.AutoMode.oldBattleManagerTBS_turnEnd=BattleManagerTBS.turnEnd,BattleManagerTBS.turnEnd=function(){Lecode.S_TBS.AutoMode.oldBattleManagerTBS_turnEnd.call(this),this._autoMode=!!this._autoModePending,LeUtilities.getScene()._windowAutoMode.refresh()},Lecode.S_TBS.AutoMode.oldBattleManagerTBS_startTurn=BattleManagerTBS.startTurn,BattleManagerTBS.startTurn=function(){Lecode.S_TBS.AutoMode.oldBattleManagerTBS_startTurn.call(this),this._autoMode=!!this._autoModePending,LeUtilities.getScene()._windowAutoMode.refresh()},Lecode.S_TBS.AutoMode.oldBattleManagerTBS_stopBattle=BattleManagerTBS.stopBattle,BattleManagerTBS.stopBattle=function(){Lecode.S_TBS.AutoMode.oldBattleManagerTBS_stopBattle.call(this),LeUtilities.getScene()._windowAutoMode.hide()},Lecode.S_TBS.AutoMode.oldInputHandlerTBS_update=InputHandlerTBS.update,InputHandlerTBS.update=function(){this.isActive()&&(BattleManagerTBS.isWaiting()||(Input.isTriggered(Lecode.S_TBS.AutoMode.input)&&LeUtilities.getScene().setAutoMode(),Lecode.S_TBS.AutoMode.oldInputHandlerTBS_update.call(this)))};